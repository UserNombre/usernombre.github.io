repositories:
  bash:
    format: "https://github.com/bminor/bash/blob/bash-5.2/${file}#L${line}"
  glibc:
    format: "https://elixir.bootlin.com/glibc/glibc-2.41/source/${file}#L${line}"
  x86:
    format: "https://www.felixcloutier.com/x86/${file}"

definitions:
  # bash types
  command_type:
    repository: "bash"
    file: "command.h"
    line: 71

  # bash functions
  reader_loop:
    repository: "bash"
    file: "eval.c"
    line: 57
  parse_command:
    repository: "bash"
    file: "eval.c"
    line: 323
  read_command:
    repository: "bash"
    file: "eval.c"
    line: 360
  execute_command:
    repository: "bash"
    file: "execute_cmd.c"
    line: 401
  execute_command_internal:
    repository: "bash"
    file: "execute_cmd.c"
    line: 573
  execute_simple_command:
    repository: "bash"
    file: "execute_cmd.c"
    line: 4355
  execute_disk_command:
    repository: "bash"
    file: "execute_cmd.c"
    line: 5586
  search_for_command:
    repository: "bash"
    file: "findcmd.c"
    line: 336
  make_child:
    repository: "bash"
    file: "jobs.c"
    line: 2121
  make_bare_simple_command:
    repository: "bash"
    file: "make_cmd.c"
    line: 496
  make_simple_command:
    repository: "bash"
    file: "make_cmd.c"
    line: 519
  bash_main:
    repository: "bash"
    file: "shell.c"
    line: 370
    symbol: "main"
  shell_initialize:
    repository: "bash"
    file: "shell.c"
    line: 1928
  yyparse:
    repository: "bash"
    file: "y.tab.c"
    line: 1700

  # glibc functions
  __libc_fork:
    repository: "glibc"
    file: "posix/fork.c"
    line: 40
  __run_prefork_handlers:
    repository: "glibc"
    file: "posix/register-atfork.c"
    line: 113
  _Fork:
    repository: "glibc"
    file: "sysdeps/nptl/_Fork.c"
    line: 25

  weak_alias:
    repository: "glibc"
    file: "include/libc-symbols.h"
    line: 153
  libc_hidden_def:
    repository: "glibc"
    file: "include/libc-symbols.h"
    line: 548
  INLINE_SYSCALL:
    repository: "glibc"
    file: "sysdeps/unix/sysv/linux/sysdep.h"
    line: 42
  INTERNAL_SYSCALL:
    repository: "glibc"
    file: "sysdeps/unix/sysv/linux/x86_64/sysdep.h"
    line: 234
  internal_syscall5:
    repository: "glibc"
    file: "sysdeps/unix/sysv/linux/x86_64/sysdep.h"
    line: 322
  __INLINE_SYSCALL5:
    repository: "glibc"
    file: "sysdeps/unix/sysdep.h"
    line: 93
  __INLINE_SYSCALL_DISP:
    repository: "glibc"
    file: "sysdeps/unix/sysdep.h"
    line: 103
  INLINE_SYSCALL_CALL:
    repository: "glibc"
    file: "sysdeps/unix/sysdep.h"
    line: 111
  arch_fork:
    repository: "glibc"
    file: "sysdeps/unix/sysv/linux/arch-fork.h"
    line: 35

  # x86 instructions
  syscall:
    repository: "x86"
    file: "syscall"
    line: 0

codepaths:
  bash_repl:
    - call: "bash_main"
      children:
        - line: 580
          call: "shell_initialize"
        - line: 833
          call: "reader_loop"
          children:
            - line: 139
              call: "read_command"
              highlight: true
            - line: 171
              call: "execute_command"
              highlight: true
  bash_read:
    - line: 139
      call: "read_command"
      children:
        - line: 392
          call: "parse_command"
          children:
            - line: 348
              call: "yyparse"
              highlight: true
              children:
                - line: 2532
                  call: "make_simple_command"
                  children:
                    - line: 528
                      call: "make_bare_simple_command"
                      children:
                        - line: 509
                          code: "command->type = cm_simple"
                          highlight: true
  bash_execute:
    - line: 171
      call: "execute_command"
      children:
        - line: 413
          call: "execute_command_internal"
          children:
            - line: 866
              call: "execute_simple_command"
              children:
                - line: 4811
                  call: "execute_disk_command"
                  children:
                    - line: 5628
                      call: "search_for_command"
                    - line: 5652
                      call: "make_child"
                      children:
                        - line: 2164
                          code: "fork"
                          highlight: true
  fork_user:
    - call: "__libc_fork"
      comment: "Our fork is an alias to this symbol"
      children:
        - line: 51
          call: "__run_prefork_handlers"
          children:
        - line: 75
          call: "_Fork"
          children:
            - line: 33
              call: "arch_fork"
              children:
                - line: 50
                  call: "INLINE_SYSCALL_CALL"
                  code: "ret = INLINE_SYSCALL_CALL (clone, flags, 0, NULL, ctid, 0)"
                  highlight: true
                  children:
                    - line: 112
                      call: "__INLINE_SYSCALL_DISP"
                      children:
                        - line: 104
                          call: "__INLINE_SYSCALL5"
                          children:
                            - line: 95
                              call: "INLINE_SYSCALL"
                              children:
                                - line: 44
                                  call: "INTERNAL_SYSCALL"
                                  children:
                                    - line: 235
                                      call: "internal_syscall5"
                                      children:
                                        - line: 336
                                          call: "syscall"
                                          highlight: true
